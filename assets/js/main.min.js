$(document).ready((function(){"use strict";var body=$("body");const baseUrl=window.location.origin;function validate(input){if("email"==$(input).attr("type")||"email"==$(input).attr("name")){if(null==$(input).val().trim().match(/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{1,5}|[0-9]{1,3})(\]?)$/))return!1}else if(""==$(input).val().trim())return!1}function showValidate(input){var thisAlert=$(input).parent();$(thisAlert).addClass("alert-validate")}function hideValidate(input){var thisAlert=$(input).parent();$(thisAlert).removeClass("alert-validate")}$((function(){$(".preloader").fadeOut(),$("#side-menu").metisMenu()})),$(".open-close").on("click",(function(){body.toggleClass("show-sidebar").toggleClass("hide-sidebar"),$(".sidebar-head .open-close i").toggleClass("ti-menu")})),$("#pass-modal").modal({keyboard:!1,backdrop:"static",show:!0}),$((function(){var set=function(){var topOffset=60,width=window.innerWidth>0?window.innerWidth:this.screen.width,height=(window.innerHeight>0?window.innerHeight:this.screen.height)-1;width<768?($("div.navbar-collapse").addClass("collapse"),topOffset=100):$("div.navbar-collapse").removeClass("collapse"),width<1170?(body.addClass("content-wrapper"),$(".sidebar-nav, .slimScrollDiv").css("overflow-x","visible").parent().css("overflow","visible")):body.removeClass("content-wrapper"),(height-=topOffset)<1&&(height=1),height>topOffset&&$("#page-wrapper").css("min-height",height+"px")},url=window.location,element=$("ul.nav-principal li a").filter((function(){return $(this).attr("href")===url||0===url.href.indexOf($(this).attr("href"))||$(this).children().find(".link-collapse").attr("href")===url})).addClass("active selected").parent().parent().addClass("in").parent();element.is("li")&&element.addClass("active").find("a.waves-effect").addClass("active"),$(window).ready(set),$(window).bind("resize",set)})),$("ul.nav.nav-pcincipal li a").click((function(){alert("assasdas"),console.log(this.href)})),$((function(){$('[data-toggle="tooltip"]').tooltip()})),$((function(){$('[data-toggle="popover"]').popover()})),$(".list-task li label").on("click",(function(){$(this).toggleClass("task-done")})),$(".settings_box a").on("click",(function(){$("ul.theme_color").toggleClass("theme_block")})),$(".collapseble").on("click",(function(){$(".collapseblebox").fadeToggle(350)})),body.trigger("resize"),$(".visited li a").on("click",(function(e){$(".visited li").removeClass("active");var $parent=$(this).parent();$parent.hasClass("active")||$parent.addClass("active"),e.preventDefault()})),$("#to-recover").on("click",(function(){$("#loginform").slideUp(),$("#recoverform").fadeIn()})),$(".navbar-toggle").on("click",(function(){$(".navbar-toggle i").toggleClass("ti-menu").addClass("ti-close")})),$(".validate-form").on("submit",(function(e){var input=$(this).find(".validate-input .input100");console.log("hola"),e.preventDefault();let check=!0,method=$(this).attr("m"),controller=capitalize($(this).attr("c")),formulario=$(this)[0];for(var i=0;i<input.length;i++)0==validate(input[i])&&(showValidate(input[i]),check=!1);if(check){let data=new FormData(formulario);if(data.append("option",method),"editar"==method&&"Equipo"==controller)data.append("id",$(this).data("id")),data.append("type",$(this).data("type"));else if("update"==method&&"User"==controller){let userData=desencrypt(localStorage.getItem("u_d"));console.log(userData);let option=$(formulario).data("option");data.append("update_op",option)}$.ajax({type:"POST",url:baseUrl+`/controllers/${controller}Controller.php`,data:data,contentType:!1,processData:!1,dataType:"json",beforeSend:function(){console.log("Enviando..")}}).done((function(response){if(console.log(response),response.status)if("login"==method){let encrypted=CryptoJS.AES.encrypt(JSON.stringify(response.usuario),key);localStorage.setItem("u_d",encrypted),window.location.reload()}else $.toast({heading:"EXITO",text:response.message,allowToastClose:!1,position:"bottom-center",loaderBg:"#003B7F",icon:"success",hideAfter:2e3,stack:2,beforeHide:()=>{"changePass"==method&&"User"==controller?$("#pass-modal").modal("hide"):"resetPassword"==method&&"User"==controller?$(".alert-modal").modal("hide"):"registro"==method&&"User"==controller?window.location.assign("index"):"delete"==method&&"Equipo"==controller?window.location.assign("index"):window.location.reload()}});else"resetPassword"!=method&&formulario.reset(),$.toast({heading:"ERROR",text:void 0===response.message?"Error en el servidor":response.message,position:"bottom-right",bgColor:"#E83B45",loaderBg:"#003B7F",icon:"error",hideAfter:4e3,stack:2})})).fail((function(response){$.toast({heading:"ERROR",text:"Error en el servidor",position:"bottom-right",bgColor:"#E83B45",loaderBg:"#003B7F",icon:"error",hideAfter:4e3,stack:2})})).always((function(response){console.log("complete")}))}})),$(".validate-form .input100").each((function(){$(this).focus((function(){hideValidate(this)}))})),$(".logout").click((function(){$.ajax({type:"POST",url:baseUrl+"/controllers/UserController.php",data:{option:"logout"},dataType:"json"}).done((function(response){response.status?(localStorage.removeItem("u_d"),window.location.assign(baseUrl)):console.log(response)})).fail((function(){console.log("error")})).always((function(){console.log("complete")}))}));const capitalize=s=>"string"!=typeof s?"":s.charAt(0).toUpperCase()+s.slice(1);$("#marca").on("change",(function(){let marca_id=$(this).val(),template='<option value="">-- Modelo del equipo --</option>';$(this).val()>=1&&$.ajax({type:"POST",url:`${baseUrl}/controllers/ModeloController.php`,data:{option:"byMarca",marca_id:marca_id},dataType:"script",beforeSend:function(){console.log("ENVIANDO")},success:function(response){let modelos;JSON.parse(response).forEach(modelo=>{template+=`\n                            <option value="${modelo.id}" class="text-capitalize">\n                                ${modelo.nombre}\n                            </option>\n                        `}),$("#modelos").html(template)}}).fail((function(){console.log("error")}))})),$("#departamentoModal").on("change",(function(){let value=$(this).val();$(this).val()>=1&&$.ajax({type:"POST",url:`${baseUrl}/helpers/utils.php`,data:{method:"Where",table:"departamentos",value:value},dataType:"json",beforeSend:function(){console.log("ENVIANDO")},success:function(response){let departamento=response;$("#m-d-descript").html(departamento.descripcion)}}).fail((function(){console.log("error")}))})),$(".mod-dep").click((function(){const id=$(this).data("id");$.ajax({type:"POST",url:`${baseUrl}/controllers/DepartamentoController.php`,data:{id:id,option:"get"},dataType:"json",success:function(response){if(response.status){const departamento=response.departamento;let modal=`<div class="form-group">\n                  <label for="username">Departamento</label>\n                  <input type="text" name="nombre" class="form-control" value="${departamento.nombre}">\n              </div>\n\n              <div class="form-group">\n                  <label for="emailaddress">Descripcion del departamento</label>\n                  <textarea class="form-control" cols="30" rows="10" name="descripcion">${departamento.descripcion}</textarea>\n              </div>\n              <input type="hidden" name="id" value="${departamento.id}">\n              <div class="form-group text-center">\n                  <button class="btn btn-block btn-primary">Guardar cambios</button>\n                  <button class="btn btn-block btn-danger" data-dismiss="modal">Cancelar</button>\n              </div>`;$("#modal-dept form.validate-form").html(modal),$("#modal-dept").modal("show")}}})})),$("#zero_config").DataTable()}));var key="seguridad pro";function desencrypt(val){return JSON.parse(CryptoJS.AES.decrypt(val,key).toString(CryptoJS.enc.Utf8))}function change(form){let user_d=desencrypt(localStorage.getItem("u_d")),inputs=$(form).children(".validate-input").find("input"),check=!1,button=$(form).find("button[type=submit]");for(let i=0;i<inputs.length;i++){const input=inputs[i],name=input.getAttribute("name");$(input).val()!=user_d[name]&&(check=!0)}check?($(button).removeAttr("disabled"),$(button).removeClass("disabled")):($(button).attr("disabled",!0),$(button).addClass("disabled"))}